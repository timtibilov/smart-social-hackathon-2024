{% extends "base.html" %}
{% block title %}Event List{% endblock %}
{% block content %}
    <h2>Events</h2>

    <form method="GET" action="{{ url_for('event.index') }}">
        <div>
            <label for="filter">Filter by:</label>
            <select name="filter" id="filter">
                <option value="all" {% if request.args.get('filter') == 'all' %}selected{% endif %}>Все</option>
                <option value="past" {% if request.args.get('filter') == 'past' %}selected{% endif %}>Прошедшие</option>
                <option value="current" {% if request.args.get('filter') == 'current' %}selected{% endif %}>Актуальные</option>
            </select>
        </div>
        <div>
            <label for="min_price">Min Price:</label>
            <input type="number" step="0.01" name="min_price" id="min_price" value="{{ request.args.get('min_price', '') }}">
        </div>
        <div>
            <label for="max_price">Max Price:</label>
            <input type="number" step="0.01" name="max_price" id="max_price" value="{{ request.args.get('max_price', '') }}">
        </div>
        <div>
            <label for="start_date">Start Date:</label>
            <input type="date" name="start_date" id="start_date" value="{{ request.args.get('start_date', '') }}">
        </div>
        <div>
            <label for="end_date">End Date:</label>
            <input type="date" name="end_date" id="end_date" value="{{ request.args.get('end_date', '') }}">
        </div>
        <div>
            <label for="q">Search:</label>
            <input type="text" name="q" id="q" value="{{ request.args.get('q', '') }}">
        </div>
        <button type="submit">Apply Filters</button>
    </form>

    <ul>
        {% for event in events %}
            <li>
                <a href="{{ url_for('event.detail', event_id=event.id) }}">{{ event.name }}</a>
                <p>{{ event.description }}</p>
                <p><strong>Place:</strong> {{ event.place }}</p>
                <p><strong>Visitor Count:</strong> {{ event.visitor_count }}</p>
                <p><strong>Next Available Date:</strong> {{ event.dates[0].date_time if event.dates else 'N/A' }}</p>
                <p><strong>Price:</strong> {{ event.dates[0].price if event.dates else 'N/A' }}</p>
            </li>
        {% endfor %}
    </ul>
{% endblock %}
