# smart-social-hackathon-2024

### Краткое описание методов и маршрутов приложения

#### 1. create()
**Маршрут:** /orders/create  
**Методы:** GET, POST
**Функциональность:** Создание нового заказа.  
**Параметры:**
  - event_id (POST): ID мероприятия.
  - event_date_id (POST): ID даты мероприятия.
  - visitor_name (POST): Имя посетителя.
  - visitor_email (POST): Электронная почта посетителя.
  - visitor_phone (POST): Телефон посетителя.
  - ticket_count (POST): Количество билетов.

#### 2. detail(order_id)
**Маршрут:** /orders/<int:order_id>  
**Методы:** GET, POST
**Функциональность:** Отображение деталей заказа и подтверждение заказа.  
**Параметры:**
  - order_id (URL): ID заказа.
  - POST без параметров: Подтверждение и оплата заказа (mock).

#### 3. check_order()
**Маршрут:** /orders/check  
**Методы:** GET, POST
**Функциональность:** Проверка заказа по номеру заказа и email или телефону.  
**Параметры:**
  - order_id (POST): Номер заказа.
  - visitor_email (POST): Электронная почта посетителя.
  - visitor_phone (POST): Телефон посетителя.

#### 4. edit(token)
**Маршрут:** /orders/edit/<token>  
**Методы:** GET, POST
**Функциональность:** Редактирование заказа по токену.  
**Параметры:**
  - token (URL): Токен для редактирования заказа.
  - visitor_name (POST): Имя посетителя (опционально, если редактируется).
  - visitor_email (POST): Электронная почта посетителя (опционально, если редактируется).
  - visitor_phone (POST): Телефон посетителя (опционально, если редактируется).
  - ticket_count (POST): Количество билетов (опционально, если редактируется).

#### 5. request_refund(token)
**Маршрут:** /staff/request_refund/<token>  
**Методы:** GET, POST
**Функциональность:** Запрос на возврат средств за заказ.  
**Параметры:**
  - token (URL): Токен для редактирования заказа.

#### 6. refund_requests()
**Маршрут:** /staff/refund_requests  
**Методы:** GET
**Функциональность:** Отображение списка запросов на возврат для сотрудников музея.  
**Параметры:** Нет

#### 7. approve_refund(request_id)
**Маршрут:** /staff/approve_refund/<int:request_id>  
**Методы:** GET
**Функциональность:** Одобрение запроса на возврат.  
**Параметры:**
  - request_id (URL): ID запроса на возврат.

#### 8. reject_refund(request_id)
**Маршрут:** /staff/reject_refund/<int:request_id>  
**Методы:** GET
**Функциональность:** Отклонение запроса на возврат.  
**Параметры:**
  - request_id (URL): ID запроса на возврат.

### Краткое описание утилитарных функций

#### 1. generate_token(order_id, salt='order-confirmation-salt')
**Функциональность:** Генерация токена для заказа.  
**Параметры:**
  - order_id (int): ID заказа.
  - salt (str): Соль для токена (по умолчанию 'order-confirmation-salt').

#### 2. confirm_token(token, expiration=3600, salt='order-confirmation-salt')
**Функциональность:** Подтверждение токена.  
**Параметры:**
  - token (str): Токен для подтверждения.
  - expiration (int): Время жизни токена в секундах (по умолчанию 3600 секунд).
  - salt (str): Соль для токена (по умолчанию 'order-confirmation-salt').

#### 3. send_confirmation_email(order)
**Функциональность:** Отправка письма с подтверждением заказа, номером заказа и ссылками на редактирование и возврат.  
**Параметры:**
  - order (Order): Объект заказа.

### Примеры использования

#### Создание заказа

1. Перейдите по адресу /orders/create.
2. Заполните форму с данными заказа:
    - Выберите мероприятие и его дату.
    - Введите имя, электронную почту и телефон.
    - Укажите количество билетов.
3. Подтвердите создание заказа.

#### Просмотр деталей заказа

1. Перейдите по адресу /orders/check.
2. Введите номер заказа и email/телефон для проверки.
3.

Если данные корректны, система перенаправит вас на страницу с деталями заказа по адресу /orders/<order_id>.

#### Редактирование заказа

1. Перейдите по ссылке на редактирование, полученной в письме с подтверждением.
2. Внесите изменения в форму редактирования.
3. Подтвердите изменения.

#### Запрос возврата заказа

1. Перейдите по ссылке на запрос возврата, полученной в письме с подтверждением.
2. Подтвердите создание запроса на возврат.

#### Обработка запросов на возврат сотрудником музея

1. Перейдите по адресу /staff/refund_requests.
2. Просмотрите список запросов на возврат.
3. Для одобрения или отклонения запроса используйте соответствующие ссылки.
